{"ast":null,"code":"import { api } from './api';\n// Token storage keys\nconst ACCESS_TOKEN_KEY = 'invest_tracker_access_token';\nconst TOKEN_TYPE_KEY = 'invest_tracker_token_type';\n\n// Serviço de autenticação\nexport const authService = {\n  // Registrar um novo usuário\n  async register(userData) {\n    const response = await api.post('/auth/register', userData);\n    return response.data;\n  },\n  // Login de usuário\n  async login(credentials) {\n    const response = await api.post('/auth/login', credentials);\n\n    // Salvar token no localStorage\n    localStorage.setItem(ACCESS_TOKEN_KEY, response.data.accessToken);\n    localStorage.setItem(TOKEN_TYPE_KEY, response.data.tokenType);\n\n    // Configurar o token no header padrão do axios\n    api.defaults.headers.common['Authorization'] = `${response.data.tokenType} ${response.data.accessToken}`;\n    return response.data;\n  },\n  // Logout de usuário\n  logout() {\n    localStorage.removeItem(ACCESS_TOKEN_KEY);\n    localStorage.removeItem(TOKEN_TYPE_KEY);\n    delete api.defaults.headers.common['Authorization'];\n  },\n  // Verificar se o usuário está autenticado\n  isAuthenticated() {\n    return !!localStorage.getItem(ACCESS_TOKEN_KEY);\n  },\n  // Obter token de acesso\n  getAccessToken() {\n    return localStorage.getItem(ACCESS_TOKEN_KEY);\n  },\n  // Obter tipo de token\n  getTokenType() {\n    return localStorage.getItem(TOKEN_TYPE_KEY);\n  },\n  // Configurar token de autenticação (usado ao inicializar a aplicação)\n  setupToken() {\n    const token = this.getAccessToken();\n    const tokenType = this.getTokenType();\n    if (token && tokenType) {\n      api.defaults.headers.common['Authorization'] = `${tokenType} ${token}`;\n    }\n  },\n  // Obter dados do usuário atual\n  async getCurrentUser() {\n    const response = await api.get('/auth/me');\n    return response.data;\n  },\n  // Atualizar dados do usuário\n  async updateUser(userData) {\n    const response = await api.put('/auth/me', userData);\n    return response.data;\n  },\n  // Atualizar senha do usuário\n  async updatePassword(passwordData) {\n    const response = await api.put('/auth/me/password', passwordData);\n    return response.data;\n  },\n  // Solicitar redefinição de senha\n  async requestPasswordReset(data) {\n    const response = await api.post('/auth/forgot-password', data);\n    return response.data;\n  },\n  // Confirmar redefinição de senha\n  async confirmPasswordReset(data) {\n    const response = await api.post('/auth/reset-password', data);\n    return response.data;\n  },\n  // Verificar email\n  async verifyEmail(data) {\n    const response = await api.post('/auth/verify-email', data);\n    return response.data;\n  }\n};\n\n// Configurar interceptor para lidar com erros de autenticação\napi.interceptors.response.use(response => response, error => {\n  if (error.response && error.response.status === 401) {\n    // Se receber um erro 401 (não autorizado), fazer logout\n    authService.logout();\n    // Redirecionar para a página de login\n    window.location.href = '/login';\n  }\n  return Promise.reject(error);\n});\n\n// Configurar token ao importar o serviço\nauthService.setupToken();","map":{"version":3,"names":["api","ACCESS_TOKEN_KEY","TOKEN_TYPE_KEY","authService","register","userData","response","post","data","login","credentials","localStorage","setItem","accessToken","tokenType","defaults","headers","common","logout","removeItem","isAuthenticated","getItem","getAccessToken","getTokenType","setupToken","token","getCurrentUser","get","updateUser","put","updatePassword","passwordData","requestPasswordReset","confirmPasswordReset","verifyEmail","interceptors","use","error","status","window","location","href","Promise","reject"],"sources":["C:/Users/ferna/INVEST_TRACKER/frontend/src/services/auth.ts"],"sourcesContent":["import axios, { AxiosResponse } from 'axios';\nimport { api } from './api';\nimport {\n  User,\n  UserRegister,\n  UserLogin,\n  UserUpdate,\n  UserPasswordUpdate,\n  AuthToken,\n  PasswordResetRequest,\n  PasswordResetConfirm,\n  VerificationRequest\n} from '../types';\n\n// Token storage keys\nconst ACCESS_TOKEN_KEY = 'invest_tracker_access_token';\nconst TOKEN_TYPE_KEY = 'invest_tracker_token_type';\n\n// Serviço de autenticação\nexport const authService = {\n  // Registrar um novo usuário\n  async register(userData: UserRegister): Promise<User> {\n    const response: AxiosResponse<User> = await api.post('/auth/register', userData);\n    return response.data;\n  },\n\n  // Login de usuário\n  async login(credentials: UserLogin): Promise<AuthToken> {\n    const response: AxiosResponse<AuthToken> = await api.post('/auth/login', credentials);\n    \n    // Salvar token no localStorage\n    localStorage.setItem(ACCESS_TOKEN_KEY, response.data.accessToken);\n    localStorage.setItem(TOKEN_TYPE_KEY, response.data.tokenType);\n    \n    // Configurar o token no header padrão do axios\n    api.defaults.headers.common['Authorization'] = `${response.data.tokenType} ${response.data.accessToken}`;\n    \n    return response.data;\n  },\n\n  // Logout de usuário\n  logout(): void {\n    localStorage.removeItem(ACCESS_TOKEN_KEY);\n    localStorage.removeItem(TOKEN_TYPE_KEY);\n    delete api.defaults.headers.common['Authorization'];\n  },\n\n  // Verificar se o usuário está autenticado\n  isAuthenticated(): boolean {\n    return !!localStorage.getItem(ACCESS_TOKEN_KEY);\n  },\n\n  // Obter token de acesso\n  getAccessToken(): string | null {\n    return localStorage.getItem(ACCESS_TOKEN_KEY);\n  },\n\n  // Obter tipo de token\n  getTokenType(): string | null {\n    return localStorage.getItem(TOKEN_TYPE_KEY);\n  },\n\n  // Configurar token de autenticação (usado ao inicializar a aplicação)\n  setupToken(): void {\n    const token = this.getAccessToken();\n    const tokenType = this.getTokenType();\n    \n    if (token && tokenType) {\n      api.defaults.headers.common['Authorization'] = `${tokenType} ${token}`;\n    }\n  },\n\n  // Obter dados do usuário atual\n  async getCurrentUser(): Promise<User> {\n    const response: AxiosResponse<User> = await api.get('/auth/me');\n    return response.data;\n  },\n\n  // Atualizar dados do usuário\n  async updateUser(userData: UserUpdate): Promise<User> {\n    const response: AxiosResponse<User> = await api.put('/auth/me', userData);\n    return response.data;\n  },\n\n  // Atualizar senha do usuário\n  async updatePassword(passwordData: UserPasswordUpdate): Promise<{ message: string }> {\n    const response: AxiosResponse<{ message: string }> = await api.put('/auth/me/password', passwordData);\n    return response.data;\n  },\n\n  // Solicitar redefinição de senha\n  async requestPasswordReset(data: PasswordResetRequest): Promise<{ message: string }> {\n    const response: AxiosResponse<{ message: string }> = await api.post('/auth/forgot-password', data);\n    return response.data;\n  },\n\n  // Confirmar redefinição de senha\n  async confirmPasswordReset(data: PasswordResetConfirm): Promise<{ message: string }> {\n    const response: AxiosResponse<{ message: string }> = await api.post('/auth/reset-password', data);\n    return response.data;\n  },\n\n  // Verificar email\n  async verifyEmail(data: VerificationRequest): Promise<{ message: string }> {\n    const response: AxiosResponse<{ message: string }> = await api.post('/auth/verify-email', data);\n    return response.data;\n  }\n};\n\n// Configurar interceptor para lidar com erros de autenticação\napi.interceptors.response.use(\n  (response) => response,\n  (error) => {\n    if (error.response && error.response.status === 401) {\n      // Se receber um erro 401 (não autorizado), fazer logout\n      authService.logout();\n      // Redirecionar para a página de login\n      window.location.href = '/login';\n    }\n    return Promise.reject(error);\n  }\n);\n\n// Configurar token ao importar o serviço\nauthService.setupToken();"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}